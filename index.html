<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Rally X - Professional Edition. Juego arcade moderno con gr√°ficos profesionales, efectos de sonido, power-ups y m√∫ltiples niveles.">
    <meta name="keywords" content="rally x, juego, arcade, html5, canvas, profesional">
    <meta name="author" content="Rally X Professional Team">
    <meta name="theme-color" content="#00d4ff">

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Rally X - Professional Edition">
    <meta property="og:description" content="Experiencia arcade profesional en tu navegador">
    <meta property="og:image" content="/assets/images/og-image.png">

    <!-- Apple Mobile Web App -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Rally X">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üèÅ</text></svg>">

    <!-- Manifest for PWA -->
    <link rel="manifest" href="manifest.json">

    <title>Rally X - Professional Edition</title>

    <!-- Preload recursos cr√≠ticos -->
    <link rel="preload" href="css/main.css" as="style">
    <link rel="preload" href="js/main.js" as="script">
    <link rel="preload" href="js/config.js" as="script">

    <!-- Estilos -->
    <link rel="stylesheet" href="css/main.css">

    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-spinner"></div>
        <div class="loading-text">CARGANDO RALLY X...</div>
    </div>

    <!-- Contenedor Principal del Juego -->
    <div class="game-container">
        <!-- Header -->
        <header class="game-header">
            <h1 class="game-title">RALLY X</h1>
            <p class="game-subtitle">PROFESSIONAL EDITION</p>
        </header>

        <!-- Canvas del Juego -->
        <canvas id="gameCanvas" width="960" height="640">
            Tu navegador no soporta HTML5 Canvas. Por favor, actualiza tu navegador.
        </canvas>

        <!-- Controles T√°ctiles (M√≥vil) -->
        <div class="touch-controls" id="touchControls">
            <div class="joystick-area" id="joystickArea">
                <div class="joystick-knob" id="joystickKnob"></div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="game-footer">
            <p>
                Controles: <strong>WASD</strong> o <strong>Flechas</strong> para moverse |
                <strong>ESC</strong> para pausar |
                <strong>R</strong> para reiniciar
            </p>
            <p style="margin-top: 10px; font-size: 0.7rem;">
                Desarrollado con ‚ù§Ô∏è usando HTML5 Canvas & JavaScript ES6+ |
                <a href="#" onclick="game?.toggleAudio(); return false;">üîä Audio</a>
            </p>
        </footer>
    </div>

    <!-- JavaScript Modules (defer autom√°tico en module) -->
    <script type="module" src="js/main.js"></script>

    <!-- Prefetch pr√≥ximos recursos para navegaci√≥n m√°s r√°pida -->
    <link rel="prefetch" href="js/states/GameState.js">
    <link rel="prefetch" href="js/entities/Player.js">
    <link rel="prefetch" href="js/entities/Enemy.js">

    <!-- Service Worker Registration (PWA) -->
    <script>
        // Registrar Service Worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('‚úÖ Service Worker registrado:', registration.scope);
                    })
                    .catch(error => {
                        console.log('‚ùå Error al registrar Service Worker:', error);
                    });
            });
        }

        // Ocultar loading screen cuando todo est√© listo
        window.addEventListener('load', () => {
            setTimeout(() => {
                const loadingScreen = document.getElementById('loadingScreen');
                if (loadingScreen) {
                    loadingScreen.style.opacity = '0';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 500);
                }
            }, 1000);
        });

        // Prevenir zoom en dispositivos m√≥viles
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        // Detectar instalaci√≥n de PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('üí° Aplicaci√≥n lista para instalar');
        });

        // Analytics y telemetr√≠a (opcional)
        window.addEventListener('error', (e) => {
            console.error('Error capturado:', e.error);
        });

        // Informaci√≥n de debug en consola
        console.log('%cüéÆ RALLY X - Professional Edition',
            'color: #00d4ff; font-size: 24px; font-weight: bold;');
        console.log('%cDesarrollado con tecnolog√≠as modernas de web',
            'color: #888; font-size: 12px;');
        console.log('%c- HTML5 Canvas para renderizado',
            'color: #ffd700; font-size: 11px;');
        console.log('%c- JavaScript ES6+ Modules',
            'color: #ffd700; font-size: 11px;');
        console.log('%c- Web Audio API para sonidos',
            'color: #ffd700; font-size: 11px;');
        console.log('%c- Progressive Web App (PWA)',
            'color: #ffd700; font-size: 11px;');
        console.log('%c- Sistema de part√≠culas avanzado',
            'color: #ffd700; font-size: 11px;');
        console.log('%c\nAccede a "game" en la consola para controlar el juego program√°ticamente',
            'color: #00ff88; font-size: 11px;');
    </script>

    <!-- Esquema JSON-LD para SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "VideoGame",
        "name": "Rally X - Professional Edition",
        "description": "Juego arcade profesional de carreras y recolecci√≥n",
        "genre": "Arcade",
        "gamePlatform": "Web Browser",
        "applicationCategory": "Game",
        "operatingSystem": "Any (HTML5)",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
</body>
</html>
